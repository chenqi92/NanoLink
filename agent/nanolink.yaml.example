# NanoLink Agent Configuration Example
# Copy this file to nanolink.yaml and customize it

# Agent settings
agent:
  # Override hostname (optional, defaults to system hostname)
  # hostname: "my-server"

  # Heartbeat interval in seconds
  heartbeat_interval: 30

  # Initial reconnect delay in seconds
  reconnect_delay: 5

  # Maximum reconnect delay in seconds
  max_reconnect_delay: 300

# Server connections
# You can connect to multiple servers with different permission levels
servers:
  # Read-only connection (monitoring only)
  - url: "wss://monitor.example.com:9100"
    token: "your_read_token_here"
    permission: 0  # READ_ONLY
    tls_verify: true

  # Admin connection (full control)
  # - url: "wss://admin.example.com:9100"
  #   token: "your_admin_token_here"
  #   permission: 3  # SYSTEM_ADMIN
  #   tls_verify: true

# Metrics collection settings
collector:
  # CPU/Memory collection interval in milliseconds
  cpu_interval_ms: 1000

  # Disk I/O collection interval in milliseconds
  disk_interval_ms: 3000

  # Network collection interval in milliseconds
  network_interval_ms: 1000

  # Process list collection interval in milliseconds
  process_interval_ms: 5000

  # Disk space collection interval in milliseconds
  disk_space_interval_ms: 30000

  # Enable disk I/O metrics
  enable_disk_io: true

  # Enable network metrics
  enable_network: true

  # Enable per-core CPU metrics
  enable_per_core_cpu: true

# Ring buffer settings (for offline data caching)
buffer:
  # Number of metrics to cache (600 = 10 minutes at 1 second interval)
  capacity: 600

# Shell command settings (use with caution!)
shell:
  # Enable shell command execution
  enabled: false

  # Super token for shell command authentication
  # This is separate from the connection token for extra security
  # super_token: "your_super_secret_token"

  # Command execution timeout in seconds
  timeout_seconds: 30

  # Whitelisted command patterns (supports * wildcard)
  # Commands must match at least one pattern to be executed
  whitelist:
    - pattern: "df -h"
      description: "Show disk space"
    - pattern: "free -m"
      description: "Show memory usage"
    - pattern: "tail -n * /var/log/*.log"
      description: "View log tail"
    - pattern: "systemctl status *"
      description: "View service status"

  # Blacklisted patterns (always blocked, checked before whitelist)
  blacklist:
    - "rm -rf"
    - "mkfs"
    - "> /dev"
    - "dd if="
    - ":(){:|:&};:"

  # Commands requiring confirmation from server
  require_confirmation:
    - pattern: "reboot"
    - pattern: "shutdown"

# Logging settings
logging:
  # Log level: trace, debug, info, warn, error
  level: info

  # Log file path (optional, logs to stdout if not set)
  # file: "/var/log/nanolink-agent.log"

  # Enable audit logging for all commands
  audit_enabled: true

  # Audit log file path
  audit_file: "nanolink-audit.log"
